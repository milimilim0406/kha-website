<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>회원가입 - 대한민국 헌터 협회</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <header style="border-bottom: 1px solid #ddd; padding: 15px 0;">
        <div class="container">
            <a href="index.html" class="logo">
                <img src="logo.png" alt="KHA" style="height: 40px;">
                <div class="logo-text">
                    <h1 style="font-size: 20px;">대한민국 헌터 협회</h1>
                </div>
            </a>
        </div>
    </header>

    <div class="container sub-content">
        <h2 class="page-title">헌터 통합 회원가입</h2>
        
        <div class="step-box">
            <span>01. 약관동의</span>
            <span class="active">02. 정보입력</span>
            <span>03. 가입완료</span>
        </div>

 <form class="signup-form">
            <table class="form-table">
                <colgroup>
                    <col style="width: 20%;">
                    <col style="width: 80%;">
                </colgroup>
                <tbody>
                    <tr>
                        <th>성명 <span class="req">*</span></th>
                        <td><input type="text" class="input-text" id="name_input"></td>
                    </tr>
                    <tr>
                        <th>헌터 등록번호 <span class="req">*</span></th>
                        <td>
                            <input type="text" class="input-text" id="hunter_id" placeholder="등록증 상단 12자리 (예: 2026-KR-XXXX)" maxlength="12">
                            <!-- ★수정됨: type="button" 추가 -->
                            <button type="button" class="btn-gray" onclick="checkHunterID()">실명확인</button>
                            <p class="tip">※ 하이픈(-) 제외 영문/숫자 12자리 입력</p>
                        </td>
                    </tr>
                    <tr>
                        <th>아이디 <span class="req">*</span></th>
                        <td>
                            <input type="text" class="input-text" id="new_id" placeholder="영문 소문자/숫자 4~12자리"> 
                            <!-- ★수정됨: type="button" 추가 -->
                            <button type="button" class="btn-gray" onclick="checkDuplicateId()">중복확인</button>
                        </td>
                    </tr>
                    <tr>
                        <th>비밀번호 <span class="req">*</span></th>
                        <td><input type="password" class="input-text"></td>
                    </tr>
                    <tr>
                        <th>비밀번호 확인 <span class="req">*</span></th>
                        <td><input type="password" class="input-text"></td>
                    </tr>
                </tbody>
            </table>

            <div class="btn-area">
                <!-- ★수정됨: 여기도 혹시 모르니 type="button" 명시 -->
                <button type="button" class="btn-submit" onclick="doSignup()">가입하기</button>
                <button type="button" class="btn-cancel" onclick="history.back()">취소</button>
            </div>
        </form>
    </div>
    
<script src="script.js"></script>
    <script>
        // 중복확인 여부를 저장하는 변수
        let isIdChecked = false;

        // 1. 헌터 등록번호 실명확인 (기존 기능)
        function checkHunterID() {
            const val = document.getElementById('hunter_id').value;
            // 관공서 특유의 앞뒤 공백 제거
            const cleanVal = val.replace(/\s/g, ''); 

            if(cleanVal.length !== 12) {
                alert("등록번호 12자리를 정확히 입력해주세요.\n(하이픈 제외)");
                document.getElementById('hunter_id').focus();
            } else {
                // 가짜 로딩 효과 (0.5초 딜레이)
                document.body.style.cursor = 'wait';
                setTimeout(() => {
                    document.body.style.cursor = 'default';
                    alert("인증되었습니다.\n[협회 DB 조회 결과: 정상 등록 헌터]");
                }, 500);
            }
        }

        // 2. ★추가된 기능★ 아이디 중복 확인
        function checkDuplicateId() {
            const idInput = document.getElementById('new_id');
            const id = idInput.value;
            
            // 유효성 검사 (관공서 스타일: 길이 체크)
            if (!id) {
                alert("아이디를 입력해주세요.");
                idInput.focus();
                return;
            }

            if (id.length < 4 || id.length > 12) {
                alert("아이디는 4자리 이상 12자리 이하로 입력해주세요.");
                idInput.focus();
                return;
            }

            // 영문과 숫자만 허용 (정규식)
            const regExp = /^[a-z0-9]+$/;
            if (!regExp.test(id)) {
                alert("아이디는 영문 소문자와 숫자만 사용할 수 있습니다.");
                idInput.value = "";
                idInput.focus();
                return;
            }

            // 가짜 DB 체크 (admin, hunter 등 뻔한 건 안 된다고 하기)
            const bannedIds = ['admin', 'root', 'hunter', 'system', 'kha', 'test'];
            
            if (bannedIds.includes(id)) {
                alert("사용할 수 없는 아이디입니다.\n(사유: 관리자 유사 아이디)");
                idInput.value = "";
                idInput.focus();
            } else {
                alert("사용 가능한 아이디입니다.");
                // 관공서 특징: 중복확인 성공하면 수정 못하게 막아버림 (readOnly)
                idInput.readOnly = true;
                idInput.style.backgroundColor = "#f0f0f0";
                isIdChecked = true;
            }
        }

        // 3. 가입하기 버튼 클릭
        function doSignup() {
            const name = document.getElementById('name_input').value;
            const hid = document.getElementById('hunter_id').value;
            const id = document.getElementById('new_id').value;

            // 필수 입력 체크
            if(name.length < 2) {
                alert("성명을 정확히 입력해주세요.");
                return;
            }
            if(hid.length < 12) {
                alert("헌터 등록번호 인증이 필요합니다.");
                return;
            }
            if(!isIdChecked) {
                alert("아이디 중복확인을 진행해주세요.");
                return;
            }
            
            // 가입 성공 시뮬레이션
            alert("회원가입이 완료되었습니다.\n[통합 회원 ID 생성됨]\n로그인 페이지로 이동합니다.");
            location.href = 'login.html';
        }
    </script>
</body>
</html>